syntax = "proto3";

package chat;
option go_package = "./proto";

service ChatService {
    rpc StartSession(StartSessionRequest) returns (StartSessionResponse);
    rpc Chat(ChatRequest) returns (ChatResponse);
    rpc Health(HealthRequest) returns (HealthResponse);
    rpc GetHistory(GetHistoryRequest) returns (GetHistoryResponse);
}

message StartSessionRequest {}

message StartSessionResponse {
  string session_id = 1;  // Server-generated UUID session ID
}

message ChatRequest {
  string session_id   = 1;  // Server-generated UUID session ID
  Model model         = 2;  // enum, defaults to 0
  string message      = 3;  // your actual chat message
  uint32 message_index = 4; // Index of last message client has, 0 for full context
}

message ChatResponse {
  string session_id   = 1;  // Server-generated UUID session ID
  string reply        = 2;
  uint32 message_count = 3; // Total messages in session after this response
}

message HealthRequest {}

message HealthResponse {
  bool ok = 1;  // Just true/false, defaults to false (0 bytes when true)
}

message GetHistoryRequest {
  string session_id = 1;  // Session to get history for
}

message GetHistoryResponse {
  string session_id = 1;  // Session ID
  repeated string messages = 2;  // All messages in session
}

enum Model {
  GEMINI_2_5_FLASH_LITE  = 0;      // default = 0 bytes in payload
  ECHO                   = 1;      // Development/testing only
}

